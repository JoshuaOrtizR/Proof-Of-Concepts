#
<h2>Palo Alto Expedition Authenticated Command Injection</h2>

- <b>Published: 2024-10-09</b>

- <b>Updated: 2024-10-17</b>

- <b>Common Vulnerabilities and Exposures ID: CVE-2024-9464</b>

- <b>CVSS v3 Score: 6.5 (Medium)</b>

- <b>Recorded Future: 64 (Medium)</b>
  
- <b>Description: This is a vulnerability in Palo Alto Networks Expedition that allows an authenticated attacker to run arbitrary OS commands as root in Expedition. This could lead to the disclosure of usernames, cleartext passwords, device configurations, and device API keys of PAN-OS firewalls. </b>

## POC
[Root Cause Analysis (RCA) & Indicators Of Comprimise (IOCs):](https://www.horizon3.ai/attack-research/palo-alto-expedition-from-n-day-to-full-compromise/)

## Usage
```
% python3 
CVE-2024-9464
.py -h
usage: 
CVE-2024-9464
.py [-h] -u URL -c CMD_FILE [-li LISTEN_IP] [-lp LISTEN_PORT]

options:
  -h, --help            show this help message and exit
  -u URL, --url URL     The URL of the target
  -c CMD_FILE, --cmd_file CMD_FILE
                        The commands to execute blind
  -li LISTEN_IP, --listen_ip LISTEN_IP
                        local IP to bind to
  -lp LISTEN_PORT, --listen_port LISTEN_PORT
                        local HTTP port to bind to, for blind RCE mode
```
## Execution:
The script reads the commands from the specified file and crafts malicious requests to the target URL. These requests exploit the vulnerability to execute the specified commands on the target system.

## Aditional Information:
*  [Horizon3 Attack Team](https://twitter.com/Horizon3Attack)
*  [James Horseman](https://twitter.com/JamesHorseman2)
*  [Zach Hanley](https://twitter.com/hacks_zach)

## SecAdmin Notes
This software has been created purely for the purposes of academic research and for the development of effective defensive techniques, and is not intended to be used to attack systems except where explicitly authorized. Project maintainers are not responsible or liable for misuse of the software. Use responsibly.

